## October 12, 2021

Two bets:
- Who holds the team with the snitch at the end of the regular season?
- Who holds the team with the most games won claiming/holding the snitch?

I've altered the second bet to make this basic analysis simpler.
The actual bet gives each team 1pt for each day they hold the snitch,
but I don't care to do that date math.


Sources:
- https://projects.fivethirtyeight.com/2022-nhl-predictions/games/
- https://github.com/fivethirtyeight/data/tree/master/nhl-forecasts
  - specifically the _latest.csv file
- https://www.nhl.com/news/nhl-announces-2021-22-regular-season-schedule/c-325741704
  - less helpful than I'd hoped


Naive approach:
Start with the Lightning's first game and build out every possible branch

Problem:
2^82 is a very big number

Wolfram Alpha says:

  4.835703278458516698824704 * 10^24
  4,835,703,278,458,516,698,824,704

This is much lower than estimated number of atoms in the Earth
(roughly 1.33 * 10^53)


I need to be smarter.


What are the goals of this analysis:
- Score each team by likelihood of holding snitch at end of season.
- Score each team by opportunities to claim the snitch.


I can think of two approaches:
a) Calculation: Which teams play Lightning most? Which teams play those teams most? Etc...
b) Simulation:  Give each team 50-50 odds to win. Simulate 10,000 seasons and count.


How confident am I in my ability to do a rigorous calculation?
Seems not-too-hard?


Matchup details from the NHL press release:

  Reminder: Scheduling Matrix
  Each Division Has Eight Teams

  Games Within Division
  5 teams x 2 home / 2 away (Subtotal 10 home / 10 away)
  1 team  x 2 home / 1 away (Subtotal 2 home / 1 away)
  1 team  x 1 home / 2 away (Subtotal 1 home / 2 away)

  Games Within Conference (Non-Division)
  4 teams x 2 home / 1 away (Subtotal 8 home / 4 away)
  4 teams x 1 home / 2 away (Subtotal 4 home / 8 away)

  Non-Conference Games
  16 teams x 1 home / 1 away (Subtotal 16 home / 16 away)

  Grand Total - 82 Games
  41 home / 41 away


I need to get this CSV from Five Thirty Eight
translated into JSON because NodeJS doesn't have
CSV parsing in the standard library.

Guess I need to write a short Python script.
Yeesh.


Before getting into that script, I should decide on
what I want the JSON to look like.

Team:
- slug
- location (Carolina, etc)
- name (Panthers, etc)

Game:
- date (YYYY-mm-dd)
- home team slug
- away team slug


### October 13, 2021

I'm more interested in writing the simulation
than in writing the calculation.


What does one season look like?
- per-team counts for "snitch games won"
- load snitch history into team scores
- track team that currently holds the snitch
- find next game for snitch team
- flip the coin
- assign snitch
- repeat


Must figure out basic date math for this.

I guess assume each game happens at 12:00:00
and add 86400000ms to move forward one day.


Back after dinner

I'm less excited about predictive analysis now

I'm more interested in telling the story of the
season, with light analysis.

Idea:
Tall page with 2 columns
- left column is a table
  - ledger of the season
  - 6 columns (1 for each owner)
  - ~82 rows (1 for each game played)
- right column
  - drawing space to display possibility tree of next 2 (3?) games


How to generate table?
Vanilla React with click events?

Why do I want click events?
Don't need them initially because the next snitch
game is always known, as are the next N possible games

Start showing:
- next game outcomes (2 branches)
- next next game outcomes (4 branches)

I think 3 levels (8 branches) is too complex
Maybe leave this as an experimental hack


So no click events
Just render the page with the information at hand


npm install --save-dev @babel/core @babel/plugin-transform-runtime @babel/preset-env @babel/preset-react  babel-loader copy-webpack-plugin html-loader  html-webpack-plugin webpack-dev-server


This install is slooooow
finished eventually

pausing for the night
will revisit later


### October 14, 2021

Hoping to get a basic React app ready to go
over lunch today

I've made a mess
I need to figure out where my root is and how
sub-projects will fit into it.

Probably put current nhl_2022 into a data directory
and build a menu page in golden_snitch root.

Clean out all draft work and replace with something in the root!


Back after dinner
Time for a new, comprehensive plan

How to structure the menu?
Array of per season/whatever dicts
in the main menu


My initial plan is to construct all branches of
the lookahead tree simultaneously.
I don't know if that makes sense.

         A   <--- Final past/speculative game
        / \
       B   \
      / \   C
     /   D / \
    /     /   E
   /     F
  G


Remember!
Dates for lookahead games are all over the place!

Do I care about representing this tree as an array?
If it were a simple
[ A, B, C, D, E, F, G ]

We know it is a binary tree.
But we also know a given game may appear more than once.

  A0
  |------------------------B(1-0)/A(0-1)
  |                        |------------D(1-0)/B(1-1)
  A(1-0)----C(1-0)/A(1-1)  |
  |                        B(2-0)
  |
  A(2-0)


What if I simplified the data structure
to just be a dictionary with this key:
  2021-10-16-NYI-FLA


Thinking more ub the dictionary plan.
I think I still need to keep the graph structure
so I can remove branches as the user builds
their speculative timeline.

Wait
No
I will always rebuild the lookahead tree from
zero based on the final completed/speculative
game on the calendar.

No need to store the branch relationships in React Component state.


I'll do a breadth-first traversal of the tree(graph?!)


Pseudocode
  - Enqueue A0 (final game on the calendar), with generation = 0
  - Dequeue a game
    - Find next game for away team, enqueue if generation < 3
    - Find next game for home team, enqueue if generation < 3


I think this is okay

Hmmmmm

Doing all this processing in render() is dumb.
I should do it all in constructor()!
- prep completed rows
- count party scores
- count per-team snitchpoints
- dictionary of date - game
- update "current" snitch holder


Making a checkpoint commit


Back after shakshuka brunch
Starting to work on the preprocessing logic

How to store pre-processed completed games?
I think an array of dictionaries makes sense.
What goes in those dictionaries?
- game date (not str)
- party name
- slug holder


Preprocessing completed games looking good


Making a commit













